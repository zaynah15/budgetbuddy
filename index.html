<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#FFB6C1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Spendora">
<title>Spendora - Your Wallet's Glow-Up üíÖ</title>
<link rel="manifest" href="./manifest.json">
<link rel="icon" type="image/png" href="./logo.png">
<link rel="apple-touch-icon" href="./logo.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<!-- React -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  
  :root {
    --bg-primary: #FFF8F2;
    --bg-secondary: #ffffff;
    --bg-card: #ffffff;
    --bg-input: #fdf9ff;
    --bg-gradient-start: #ffe2ee;
    --bg-gradient-end: #f0e4ff;
    --text-primary: #7c5a8a;
    --text-secondary: #b09cc0;
    --text-tertiary: #c8aed8;
    --border-color: #f0e2ff;
    --shadow: rgba(180,140,200,0.12);
    --shadow-heavy: rgba(180,140,200,0.25);
    --ring-track: #f0e4fa;
  }
  
  body.dark-mode {
    --bg-primary: #1a0a20;
    --bg-secondary: #2d1a35;
    --bg-card: #2d1a35;
    --bg-input: #3a2445;
    --bg-gradient-start: #2d1535;
    --bg-gradient-end: #1a0a20;
    --text-primary: #e8d0f0;
    --text-secondary: #c8a8d8;
    --text-tertiary: #a888c0;
    --border-color: #4a3455;
    --shadow: rgba(0,0,0,0.3);
    --shadow-heavy: rgba(0,0,0,0.5);
    --ring-track: #3a2a45;
  }
  
  body { 
    background: var(--bg-primary);
    font-family: 'Nunito', sans-serif; 
    -webkit-font-smoothing: antialiased;
    overscroll-behavior: none;
    transition: background 0.3s ease;
  }
  
  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
  
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { 
    background: var(--text-tertiary); 
    border-radius: 99px; 
  }

  @keyframes fadeIn { from{opacity:0;}to{opacity:1;} }
  @keyframes popIn { from{opacity:0;transform:scale(0.6);}to{opacity:1;transform:scale(1);} }
  @keyframes float { from{transform:translateY(0px);}to{transform:translateY(-15px);} }
  @keyframes spin { from{transform:rotate(0deg);}to{transform:rotate(360deg);} }
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FIREBASE CONFIG
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY_HERE",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
  appId: "YOUR_APP_ID"
};

let auth, db, isFirebaseConfigured = false;
try {
  if (firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    auth = firebase.auth();
    db = firebase.firestore();
    isFirebaseConfigured = true;
  }
} catch (error) {
  console.error("Firebase initialization error:", error);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SIGN IN SCREEN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function SignInScreen({ isDark }) {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const handleGoogleSignIn = async () => {
    if (!isFirebaseConfigured) {
      setError("Firebase not configured. Please check FIREBASE_SETUP_GUIDE.md");
      return;
    }
    
    setLoading(true);
    setError(null);
    
    try {
      const provider = new firebase.auth.GoogleAuthProvider();
      await auth.signInWithPopup(provider);
    } catch (err) {
      console.error("Sign in error:", err);
      if (err.code === 'auth/popup-closed-by-user') {
        setError("Sign-in cancelled");
      } else if (err.code === 'auth/network-request-failed') {
        setError("Network error. Check your connection.");
      } else {
        setError("Sign-in failed: " + err.message);
      }
      setLoading(false);
    }
  };

  return (
    <div style={{
      minHeight:"100dvh",
      background: `linear-gradient(160deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%)`,
      display:"flex",
      alignItems:"center",
      justifyContent:"center",
      padding:"20px",
    }}>
      <div style={{
        background: "var(--bg-card)",
        borderRadius:32,
        padding:"48px 36px",
        maxWidth:420,
        width:"100%",
        boxShadow: `0 32px 80px var(--shadow-heavy)`,
        textAlign:"center",
        animation:"popIn 0.5s cubic-bezier(.34,1.56,.64,1)",
      }}>
        {/* Logo */}
        <div style={{marginBottom:24}}>
          <img 
            src="./logo.png" 
            alt="Spendora Logo"
            style={{
              width:120,
              height:120,
              animation:"float 3s ease-in-out infinite alternate"
            }}
          />
        </div>
        
        <h1 style={{
          fontFamily:"'Nunito',sans-serif",
          fontSize:36,
          fontWeight:900,
          background:"linear-gradient(135deg,#FFB6C1,#c8a0e0)",
          WebkitBackgroundClip:"text",
          WebkitTextFillColor:"transparent",
          marginBottom:8,
        }}>Spendora</h1>
        
        <p style={{
          fontFamily:"'Nunito',sans-serif",
          fontSize:16,
          fontWeight:700,
          color: "var(--text-secondary)",
          marginBottom:32,
          lineHeight:1.5,
        }}>
          Your Wallet's Glow-Up üíÖ
        </p>

        {!isFirebaseConfigured && (
          <div style={{
            background:"#fff3cd",
            border:"2px solid #ffc107",
            borderRadius:16,
            padding:"12px",
            marginBottom:20,
            fontFamily:"'Nunito',sans-serif",
            fontSize:13,
            fontWeight:700,
            color:"#856404",
            textAlign:"left",
          }}>
            ‚ö†Ô∏è <strong>Setup Required:</strong> Please configure Firebase.<br/>
            See <code>FIREBASE_SETUP_GUIDE.md</code>
          </div>
        )}

        {error && (
          <div style={{
            background:"#fff0f0",
            border:"2px solid #ff6b6b",
            borderRadius:16,
            padding:"12px",
            marginBottom:20,
            fontFamily:"'Nunito',sans-serif",
            fontSize:13,
            fontWeight:700,
            color:"#ff6b6b",
          }}>{error}</div>
        )}

        <button
          onClick={handleGoogleSignIn}
          disabled={loading || !isFirebaseConfigured}
          style={{
            width:"100%",
            background: (loading || !isFirebaseConfigured) ? "#e8ddf0" : "white",
            border: `2px solid var(--border-color)`,
            borderRadius:16,
            padding:"16px 24px",
            fontFamily:"'Nunito',sans-serif",
            fontSize:16,
            fontWeight:900,
            color: (loading || !isFirebaseConfigured) ? "#c8b8d8" : "var(--text-primary)",
            cursor: (loading || !isFirebaseConfigured) ? "not-allowed" : "pointer",
            display:"flex",
            alignItems:"center",
            justifyContent:"center",
            gap:12,
            boxShadow: `0 4px 16px var(--shadow)`,
            transition:"all 0.2s ease",
          }}
        >
          {loading ? (
            <>
              <div style={{
                width:20, height:20,
                border:"3px solid #e8ddf0",
                borderTopColor:"#9b6dbd",
                borderRadius:"50%",
                animation:"spin 0.8s linear infinite",
              }}/>
              Signing in...
            </>
          ) : (
            <>
              <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
              Continue with Google
            </>
          )}
        </button>

        <div style={{
          marginTop:24,
          fontFamily:"'Nunito',sans-serif",
          fontSize:12,
          fontWeight:700,
          color: "var(--text-tertiary)",
          lineHeight:1.6,
        }}>
          Sign in to sync your data across devices<br/>
          and share with friends ü§ù
        </div>
      </div>
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MAIN APP
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function Spendora() {
  const [user, setUser] = useState(null);
  const [authLoading, setAuthLoading] = useState(true);
  const [theme, setTheme] = useState(() => {
    try {
      return localStorage.getItem('spendora_theme') || 'light';
    } catch {
      return 'light';
    }
  });

  // Initialize theme
  useEffect(() => {
    document.body.classList.toggle('dark-mode', theme === 'dark');
    localStorage.setItem('spendora_theme', theme);
  }, [theme]);

  // Auth listener
  useEffect(() => {
    if (!isFirebaseConfigured) {
      setAuthLoading(false);
      return;
    }

    const unsubscribe = auth.onAuthStateChanged((firebaseUser) => {
      setAuthLoading(false);
      if (firebaseUser) {
        setUser({
          uid: firebaseUser.uid,
          email: firebaseUser.email,
          displayName: firebaseUser.displayName,
          photoURL: firebaseUser.photoURL,
        });
      } else {
        setUser(null);
      }
    });

    return () => unsubscribe();
  }, []);

  const handleSignOut = async () => {
    try {
      await auth.signOut();
    } catch (error) {
      console.error("Sign out error:", error);
    }
  };

  const toggleTheme = () => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  };

  if (authLoading) {
    return (
      <div style={{
        minHeight:"100dvh",
        background: `linear-gradient(160deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%)`,
        display:"flex",
        alignItems:"center",
        justifyContent:"center",
      }}>
        <div style={{textAlign:"center"}}>
          <img 
            src="./logo.png" 
            alt="Spendora"
            style={{
              width:80,
              height:80,
              marginBottom:16,
              opacity:0.6,
              animation:"float 1.5s ease-in-out infinite alternate"
            }}
          />
          <div style={{
            fontFamily:"'Nunito',sans-serif",
            fontSize:18,
            fontWeight:800,
            color: "var(--text-secondary)",
          }}>Loading...</div>
        </div>
      </div>
    );
  }

  if (!user) {
    return <SignInScreen isDark={theme === 'dark'} />;
  }

  return (
    <div style={{
      minHeight:"100dvh",
      background: "var(--bg-primary)",
      padding:"20px",
    }}>
      {/* Theme Toggle */}
      <button
        onClick={toggleTheme}
        style={{
          position:"fixed",
          top:20,
          right:20,
          zIndex:10001,
          width:48,
          height:48,
          borderRadius:"50%",
          background: theme === 'dark'
            ? "linear-gradient(135deg,#FFB6C1,#ffd700)"
            : "linear-gradient(135deg,#4a4a6a,#2d2d4a)",
          border:"none",
          cursor:"pointer",
          display:"flex",
          alignItems:"center",
          justifyContent:"center",
          fontSize:24,
          boxShadow: `0 4px 16px var(--shadow)`,
        }}
      >
        {theme === 'dark' ? '‚òÄÔ∏è' : 'üåô'}
      </button>

      {/* User Profile */}
      <div style={{
        position:"fixed",
        top:20,
        left:20,
        zIndex:10001,
        display:"flex",
        alignItems:"center",
        gap:12,
        background: "var(--bg-card)",
        padding:"8px 16px 8px 8px",
        borderRadius:999,
        boxShadow: `0 4px 16px var(--shadow)`,
      }}>
        <img
          src={user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.displayName || 'User')}&background=FFB6C1&color=fff`}
          alt="Profile"
          style={{
            width:36,
            height:36,
            borderRadius:"50%",
            border:"2px solid #FFB6C1",
          }}
        />
        <div>
          <div style={{
            fontFamily:"'Nunito',sans-serif",
            fontSize:13,
            fontWeight:900,
            color: "var(--text-primary)",
          }}>
            {user.displayName?.split(' ')[0] || 'User'}
          </div>
          <button
            onClick={handleSignOut}
            style={{
              fontFamily:"'Nunito',sans-serif",
              fontSize:10,
              fontWeight:700,
              color: "var(--text-tertiary)",
              background:"none",
              border:"none",
              cursor:"pointer",
              padding:0,
            }}
          >Sign Out</button>
        </div>
      </div>

      {/* Main Content */}
      <div style={{
        maxWidth:480,
        margin:"80px auto 0",
        textAlign:"center",
      }}>
        <img 
          src="./logo.png" 
          alt="Spendora"
          style={{
            width:150,
            height:150,
            marginBottom:24,
          }}
        />
        
        <h1 style={{
          fontFamily:"'Nunito',sans-serif",
          fontSize:32,
          fontWeight:900,
          color: "var(--text-primary)",
          marginBottom:8,
        }}>Welcome to Spendora!</h1>
        
        <p style={{
          fontFamily:"'Nunito',sans-serif",
          fontSize:18,
          fontWeight:700,
          color: "var(--text-secondary)",
          marginBottom:32,
        }}>
          Your Wallet's Glow-Up üíÖ
        </p>

        <div style={{
          background: "var(--bg-card)",
          borderRadius:20,
          padding:"24px",
          boxShadow: `0 4px 24px var(--shadow)`,
          textAlign:"left",
        }}>
          <h2 style={{
            fontFamily:"'Nunito',sans-serif",
            fontSize:20,
            fontWeight:900,
            color: "var(--text-primary)",
            marginBottom:16,
          }}>üéâ App is Working!</h2>
          
          <p style={{
            fontFamily:"'Nunito',sans-serif",
            fontSize:14,
            color: "var(--text-secondary)",
            lineHeight:1.6,
            marginBottom:12,
          }}>
            ‚úÖ New branding: Spendora with rupee bow logo<br/>
            ‚úÖ Firebase authentication working<br/>
            ‚úÖ Dark mode toggle functional<br/>
            ‚úÖ PWA 404 error fixed with relative paths
          </p>

          <div style={{
            background: theme === 'dark' ? "#3a2445" : "#f0e4ff",
            borderRadius:12,
            padding:"12px",
            fontFamily:"'Nunito',sans-serif",
            fontSize:12,
            color: "var(--text-secondary)",
            marginTop:16,
          }}>
            <strong>Next:</strong> I'm building the complete app with all your requested features (salary tracking, star system, smart notifications, etc.)
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<Spendora/>);

// Register service worker for PWA
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js', { scope: './' })
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.log('SW registration failed:', err));
  });
}
</script>
</body>
</html>
